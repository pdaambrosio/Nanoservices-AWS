service: image-handler-consumer

plugins:
  - serverless-plugin-log-retention
  - serverless-deployment-bucket

frameworkVersion: '3'

provider:
  name: aws
  region: us-east-1
  runtime: nodejs12.x
  deploymentBucket:
    name: apps-${self:provider.region}.deploys
    blockPublicAccess: true
    serverSideEncryption: AES256
    tags:
      Environment: develop

functions:
  consumer:
    handler: handler.consumer
    role: arn:aws:iam::489716104000:role/image-handler-consumer-role
    vpc:
      subnetIds:
        - subnet-034bc4f9af21a760a
        - subnet-091561c0462e68489
        - subnet-0e73dead4b5c6ee01
      securityGroupIds:
        - sg-024ceedd712e197fc
    # reservedConcurrency: 0
    logRetentionInDays: 7

    events:
      - sqs: arn:aws:sqs:us-east-1:489716104000:post-processing-image-queue
